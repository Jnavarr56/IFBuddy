<%= content_tag :h1, "Your Fast History" %>

<% @fasts.each.with_index do |fast, i| %>

    <div class="card">
        <h5 class="card-header">
            <span class="fast-time-points">
                <%= "#{fast.get_start_date_obj}" %>
            </span> 
            -
            <span class="<%= fast.active ? "PRESENT" : "fast-time-points" %>">
                <%= "#{fast.active ? "Current" : fast.updated_at - 5.hours}" %>
            </span> 
        </h5>
        <div class="card-body">
            <h5 class="card-title">
                <%= "#{fast.max_streak > 0 ? "Max Check In Streak: #{fast.max_streak} Day#{fast.max_streak > 1 ? "s" : ""}" : "No Check Ins"}" %>
            </h5>
            <p class="card-text">
                <span class="needs-ordinal-indicator"><%= "#{@fasts.size - i}" %></span> Fast Attempted
                <br>
                <%= "Eating Window: #{fast.eating_window_length.to_i} hrs" %>
                <br>
                <%= "Fasting Window: #{fast.fasting_window_length.to_i} hrs" %>
                <br>
                <%= "Total Days Checked In: #{fast.checks.size}" %>
                <br>
                <%= "Total Days in Fast: #{(((fast.updated_at - 5.hours) - fast.get_start_date_obj)/(24*60*60)).round(4)}" %>
            </p>
            <% if fast.checks.exists? %>
                <a href="<%= "/fasts/#{fast.id}/checks" %>" class="btn btn-primary">View Check Ins</a>
            <% end %>
                <a href="/" data-delete-fast-id="<%= fast.id %>" class="btn btn-danger delete-fast-card-button">Delete this Fast Record</a>
        </div>
    </div>

<% end %>
<br>
<%= link_to "Back", :back %>

<% if @fasts.exists? %>

    <div class="modal fade" id="confirmDeleteFastFromCardModal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteFastFromCardTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="confirmDeleteFastFromCardTitle">Confirm</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" id="confirmDeleteFastFromCardContent">
            <p>Are you sure you want to delete this Fast record?<br><br>It can not be undone.</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" id="confirm-delete-fast-button" class="btn btn-danger">Yes</button>
        </div>
        </div>
    </div>
    </div>

    <div class="modal fade" id="deleteFastFromCardErrorModal" tabindex="-1" role="dialog" aria-labelledby="deleteFastFromCardErrorTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="deleteFastFromCardErrorTitle">Technical Issues</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" id="deleteFastFromCardErrorContent">
            <p>Sorry, we couldn't delete this Fast record right now. Try again later.</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Ok</button>
        </div>
        </div>
    </div>
    </div>

<% end %>



